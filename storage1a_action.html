<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è²¸å‡ºã‚·ã‚¹ãƒ†ãƒ  / Lending System</title>
  <link rel="stylesheet" href="styles.css?v=8">
</head>
<body>
  <main>
    <!-- =============================== -->
    <!-- ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ« / Main Title -->
    <!-- =============================== -->
    <h2>ğŸ“¦ è²¸å‡ºã‚·ã‚¹ãƒ†ãƒ  / Lending System</h2>

    <!-- =========================================== -->
    <!-- ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå€‰åº«åï¼‰/ Subheader (Storage) -->
    <!-- =========================================== -->
    <h3>STORAGE1-Aï¼ˆã‚¹ãƒˆãƒƒã‚¯ç®¡ç†ã‚¨ãƒªã‚¢ï¼‰</h3>

    <!-- =============================================== -->
    <!-- æ“ä½œé¸æŠãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ / Instruction for Action -->
    <!-- =============================================== -->
    <p>æ“ä½œã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚<br>Select an action below:</p>

    <!-- =============================================== -->
    <!-- æ“ä½œãƒœã‚¿ãƒ³ / Action Buttons -->
    <!-- =============================================== -->
    <button onclick="goTo('borrow')">è²¸å‡º / Borrow</button>
    <button onclick="goTo('return')">è¿”å´ / Return</button>
    <button onclick="goTo('adjust')">èª¿æ•´ / Adjust</button>
    <button onclick="viewInventory()">åœ¨åº«ã‚’è¦‹ã‚‹ / View Inventory</button>

    <!-- =============================================== -->
    <!-- åœ¨åº«è¡¨ç¤ºç”¨ / Inventory Display -->
    <!-- =============================================== -->
    <div id="inventoryDisplay" style="margin-top:20px;"></div>

    <!-- =============================== -->
    <!-- ãƒ­ã‚´ / Company Logo -->
    <!-- =============================== -->
    <div style="margin-top:40px;">
      <img src="CA_Logo.jpg?v=8" alt="Company Logo" style="max-width:200px; width:50%; height:auto;">
    </div>
  </main>

  <!-- =============================== -->
  <!-- ãƒ•ãƒƒã‚¿ãƒ¼ / Footer -->
  <!-- =============================== -->
  <footer>
    <p>Â© <span id="year"></span> ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆæ ªï¼‰</p>
  </footer>

  <!-- =============================== -->
  <!-- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ / Scripts -->
  <!-- =============================== -->
  <script>
    // ç¾åœ¨ã®å¹´ã‚’è‡ªå‹•çš„ã«è¡¨ç¤º / Automatically display the current year
    document.getElementById("year").textContent = new Date().getFullYear();

    // æ“ä½œãƒšãƒ¼ã‚¸ã«ç§»å‹• / Navigate to action page
    function goTo(action) {
      window.location.href = `storage.html?action=${action}`;
    }

    // åœ¨åº«ã‚’å–å¾—ã—ã¦è¡¨ç¤º / Fetch inventory from API and display
    function viewInventory() {
      const apiUrl = 'https://script.google.com/macros/s/AKfycbwjlcYtHr30JmDdQTG6SnYyl1z0rEbGrCwYtT1MtEmBfQyT3GhOHAa5ZNrbA4RGBhCZ/exec?action=view&storage=storage1a';

      fetch(apiUrl)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById('inventoryDisplay');
          container.innerHTML = ''; // ä»¥å‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢ / Clear previous table

          if (data.status === 'success') {
            const table = document.createElement('table');
            table.classList.add('inventory-table');

            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ / Header row
            const headerRow = document.createElement('tr');
            data.data[0].forEach(header => {
              const th = document.createElement('th');
              th.textContent = header;
              headerRow.appendChild(th);
            });
            table.appendChild(headerRow);

            // ãƒ‡ãƒ¼ã‚¿è¡Œ / Data rows
            for (let i = 1; i < data.data.length; i++) {
              const row = document.createElement('tr');
              data.data[i].forEach(cell => {
                const td = document.createElement('td');
                td.textContent = cell;
                row.appendChild(td);
              });
              table.appendChild(row);
            }

            container.appendChild(table);
          } else {
            container.textContent = 'ã‚¨ãƒ©ãƒ¼: ' + data.message;
          }
        })
        .catch(err => {
          document.getElementById('inventoryDisplay').textContent = 'é€šä¿¡ã‚¨ãƒ©ãƒ¼: ' + err.message;
        });
    }
  </script>
</body>
</html>
